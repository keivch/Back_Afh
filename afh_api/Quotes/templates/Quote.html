<!DOCTYPE html>

<html lang="es">

<head>
  <meta charset="UTF-8" />
  <title>Cotización {{ code }}</title>
  <style>
    @page {
      size: A4;
      margin: 15mm 20mm 20mm 20mm;
      /* Configuración específica para WeasyPrint */
      -weasy-print-resolution: 96dpi;
    }

    /* Rectángulo en el área superior izquierda */
    @page {
      @top-left-corner {
        content: "";
        display: block;
        width: 6mm;
        height: 15mm;
        background: #99E63C;
        border-radius: 2px;
      }
    }

    /* Configuración global para WeasyPrint - tamaño de fuente fijo */
    * {
      font-size: 12px !important;
    }

    body {
      font-family: Arial, sans-serif;
      font-size: 12px; /* Tamaño fijo para WeasyPrint */
      color: #000;
      margin: 20px;
      position: relative;
      padding-bottom: 100px;
      line-height: 1.6;
      /* Espacio para el footer */
      /* Configuración específica para WeasyPrint */
      -weasy-print-resolution: 96dpi;
    }

    /* Imagen de fondo con opacidad */
    body::before {
      content: "";
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 300px;
      height: 300px;
      background-image: url("https://res.cloudinary.com/dp4tvthea/image/upload/v1756313054/afhlogoazul_rxcpcv.png");
      background-repeat: no-repeat;
      background-position: center;
      background-size: contain;
      opacity: 0.08;
      z-index: -1;
      pointer-events: none;
    }

    .header,
    .datos-cotizacion,
    .opcion,
    .condiciones,
    .firma {
      position: relative;
      z-index: 1;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 30px;
    }

    .logo {
      height: 70px;
    }

    .titulo {
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 20px;
    }

    h1,
    h2,
    h3 {
      margin: 0;
      text-decoration: underline;
      margin-bottom: 15px;
      margin-top: 25px;
    }

    .datos-cotizacion,
    .condiciones,
    .firma {
      margin-top: 30px;
      margin-bottom: 25px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      background-color: rgba(255, 255, 255, 0.9);
      font-size: 12px; /* Tamaño fijo para WeasyPrint */
    }

    th,
    td {
      border: 1px solid #000;
      padding: 10px;
      text-align: center;
      font-size: 12px; /* Tamaño fijo para WeasyPrint */
    }

    th {
      background-color: #f2f2f2;
      /* Evitar repetición del encabezado en páginas siguientes */
      -weasy-print-page-break: avoid;
    }

    /* Evitar que el encabezado se repita en páginas siguientes */
    thead {
      display: table-header-group;
      -weasy-print-page-break: avoid;
    }

    /* Para WeasyPrint, evitar repetición de encabezados */
    .opcion table thead {
      display: table-row-group;
    }

    .item {
      text-align: left;
    }

    /* Dar más anchura a la columna de descripción */
    .opcion table th:nth-child(2),
    .opcion table td:nth-child(2) {
      width: 45%; /* Aumentar el ancho de la columna descripción */
      text-align: left;
    }

    /* Ajustar anchos de otras columnas */
    .opcion table th:nth-child(1),
    .opcion table td:nth-child(1) {
      width: 8%; /* ITEM */
    }

    .opcion table th:nth-child(3),
    .opcion table td:nth-child(3) {
      width: 8%; /* UND */
    }

    .opcion table th:nth-child(4),
    .opcion table td:nth-child(4) {
      width: 8%; /* CANT */
    }

    .opcion table th:nth-child(5),
    .opcion table td:nth-child(5) {
      width: 15%; /* VALOR UNITARIO */
    }

    .opcion table th:nth-child(6),
    .opcion table td:nth-child(6) {
      width: 16%; /* VALOR TOTAL */
    }

    .total {
      font-weight: bold;
      text-align: right;
    }

    ol.tareas {
      margin-top: 15px;
      padding-left: 25px;
      margin-bottom: 20px;
    }

    ol.tareas li {
      margin-bottom: 5px;
    }

    ul {
      margin-top: 5px;
      padding-left: 25px;
      margin-bottom: 2px;
    }

    p {
      margin-bottom: 15px;
      line-height: 1.6;
    }

    .firma {
      margin-top: 50px;
    }

    .tabla-cotizacion {
      width: 100%;
      border-collapse: collapse;
      border: 1px solid black;
    }

    .tabla-cotizacion td {
      border: 1px solid black;
      padding: 8px;
      vertical-align: middle;
    }

    .logo {
      text-align: center;
      width: 18%;
    }

    .logo img {
      width: 60px;
      margin-bottom: 3px;
    }

    .estado-vigente {
      color: green;
      font-weight: bold;
      font-size: 10px;
    }

    .titulo {
      text-align: center;
      font-weight: bold;
      font-size: 14px;
    }

    .version {
      text-align: center;
      font-size: 12px;
    }

    .datos-superior,
    .datos-inferior {
      width: 28%;
      font-size: 11px;
    }

    .paginas {
      width: 12%;
      font-size: 11px;
      text-align: center;
    }

    .table-cotizacion {
      margin-bottom: 15px;
    }

    .footer {
      bottom: 0;
      right: 0;
      font-size: 12px;
      color: #000;
      background-color: rgba(255, 255, 255, 0.8);
      /* Opacidad sutil */
      padding: 8px 12px;
      text-align: right;
      z-index: 999;
      border: none;
      box-shadow: none;
      opacity: 0.6;
      /* Opacidad del footer */
    }

    .valores {
      margin-top: 0;
      /* Elimina el margen superior */
      text-align: right;
      /* Alinea el contenido a la derecha */
    }

    .valores-grid {
      display: inline-block;
      /* Para que se ajuste al contenido */
      text-align: left;
      /* Mantiene el texto alineado a la izquierda dentro del bloque */
    }

    .valores-row {
      display: flex;
      justify-content: space-between;
      margin: 2px 0;
      /* Espaciado mínimo entre líneas */
      min-width: 200px;
      /* Ancho mínimo para mantener consistencia */
    }

    .valores-label {
      font-weight: bold;
      margin-right: 20px;
      /* Espacio entre columnas */
    }

    .valores-amount {
      text-align: right;
      flex-shrink: 0;
    }

    .total-final {
      background-color: transparent;
      color: black;
      font-weight: bold;
    }

    .total-label {
      background-color: transparent;
      color: black;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <div class="decorativo-rectangulo"></div>
  <div class="table-cotizacion">
    <table class="tabla-cotizacion">
      <tr>
        <td rowspan="2" class="logo">
          <img src={{logo_url}} alt="Logo de la empresa" />
          <div class="estado-vigente">DOCUMENTO VIGENTE</div>
        </td>
        <td class="titulo" colspan="1">COTIZACIONES</td>
        <td class="datos-superior">
          <strong>Código:</strong> F-GC-05<br />
          <strong>Fecha de Creación:</strong> 19-07-2022
        </td>
      </tr>
      <tr>
        <td class="version">RV-{{revision}}</td>
        <td class="datos-inferior">
          <strong>Fecha de Revisión:</strong> 19-07-2022 <br />
        </td>
      </tr>
    </table>
  </div>

  <div class="header">
    <div class="titulo">COTIZACIÓN N.º {{ code }} - {{revision}}</div>
  </div>

  <div style="margin-bottom: 25px;">
    Palmira, {{fecha}}

    <br><br>Señores:<br />
    {{ customer }}<br />
    {{representative}}<br />
    <br>Agradeciéndole de antemano su amable invitación para cotizarle el
    siguiente trabajo:<br />
    <strong>"{{ descripcion }}"</strong>
  </div>

  <div class="datos-cotizacion">
    <h3>ALCANCE DE LA OFERTA</h3>
    <p>
      A.F.H Metalmecánico S.A.S, ofrece el suministro de personal con
      experiencia, para desarrollar trabajo, dirección técnica y supervisión,
      concerniente a: <strong> {{ descripcion }}. </strong>
    </p>

    <ol class="tareas">
      {% for task in tasks %}
      <li>{{ task }}</li>
      {% endfor %}
    </ol>
  </div>

  <div class="opcion">
    <table>
      <thead>
        <tr>
          <th>ITEM</th> <!-- Nueva columna para el número del ítem -->
          <th>DESCRIPCIÓN</th>
          <th>UND</th>
          <th>CANT</th>
          <th>VALOR UNITARIO</th>
          <th>VALOR TOTAL</th>
        </tr>
      </thead>
      <tbody>
        {% for item in opcion.items %}
        <tr>
          <td>{{ forloop.counter }}</td> <!-- Número del ítem -->
          <td class="item">{{ item.description }}</td>
          <td>{{ item.units }}</td>
          <td>{{ item.amount }}</td>
          <td>{{ item.unit_value_formatted }}</td>
          <td>{{ item.total_value_formatted }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="valores">
    <div class="valores-grid">
      <div class="valores-row">
        <span class="valores-label">Sub-Total:</span>
        <span class="valores-amount">{{opcion.subtotal}}</span>
      </div>
      {% if construction %}
      <div class="valores-row">
        <span class="valores-label">Utilidad:</span>
        <span class="valores-amount">{{utility}}</span>
      </div>
      <div class="valores-row">
        <span class="valores-label">Imprevistos:</span>
        <span class="valores-amount">{{unforeseen}}</span>
      </div>
      <div class="valores-row">
        <span class="valores-label">Administración:</span>
        <span class="valores-amount">{{administration}}</span>
      </div>
      {% endif %}
      <div class="valores-row">
        <span class="valores-label">IVA:</span>
        <span class="valores-amount">{{iva}}</span>
      </div>
      <div class="valores-row">
        <span class="valores-label">Total:</span>
        <span class="valores-amount">{{total_value}}</span>
      </div>
    </div>
  </div>

  <div class="condiciones">
    <h3>CONDICIONES COMERCIALES</h3>
    <ul>
      <li>
        El valor estimado de los trabajos a realizar está desglosado en los
        cuadros anteriores.
      </li>
      <li>
        El valor final se ajustará según obra ejecutada y precios unitarios
        propuestos.
      </li>
    </ul>

    <h3>CORRE POR CUENTA DEL CONTRATISTA</h3>
    <ul>
      {% for item in contractor_materials %}
      <li>{{ item }}</li>
      {% endfor %}
    </ul>


    <h3>CORRE POR CUENTA DEL CONTRATANTE</h3>
    <ul>
      {% for item in contracting_materials %}
      <li>{{ item }}</li>
      {% endfor %}
    </ul>

    <h3>FORMA DE PAGO</h3>
    <p>Nos permitimos solicitar la siguiente forma de pago:</p>
    <ul>
      <li>
        <p>{{method_of_payment}}</p>
      </li>
    </ul>


    <h3>PLAZO DE ENTREGA</h3>
    <p>{{delivery_time}}</p>


    <h3>VALIDEZ DE LA PROPUESTA</h3>
    <p>30 días desde su emisión.</p>
     
    <p>Agradecemos su amable atención a la presente, esperamos que nuestra oferta cumpla sus requerimientos y gustosamente les atendemos para cualquier aclaración al respecto</p>
      

  </div>

  <div class="firma">
    <p>Atentamente,</p>
    <br /><br />
    <strong>ANDRES FELIPE HERNANDEZ</strong><br />
    Gerente General
  </div>

  <footer class="footer">
    <p>
      Carrera 13A # 40 - 37 B/Primero de Mayo, Palmira - Colombia<br />
      Cel (+57) 311 616 7972 | Fijo (602) 287 2362<br />
      afh@afhmetalmecanico.com<br />
      www.afhmetalmecanico.com
    </p>
  </footer>
</body>

</html>